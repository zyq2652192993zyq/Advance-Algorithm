> # 计算几何——固定半径圆能覆盖平面上的最大点数

给定一个半径为$r$的圆，给定一系列平面上的点，并给出横纵坐标，问圆最多能覆盖多少个点。点在圆上或者在圆内都被视为覆盖。

- [ ] POJ 1981 Circle and Points
- [ ] LeetCode 圆形靶内的最大飞镖数量













# 暴力枚举

一种思路是从平面点里面任意选出两个点，以这两个点的距离为弦，然后判断其他点是否在圆内或圆上。时间复杂度$O(n^3)$。

# 平面扫描

以每一个点做为圆心画一个圆，枚举与其相交的其他圆，保存交点和角度，按角度排序，再次扫描一遍。时间复杂度$O(n^2 \log n)$。

<img src="D:\Kylin\Advance-Algorithm\Algorithm Analysis\计算几何——固定半径圆能覆盖平面上的最大点数.assets\image-20200517154917845.png" alt="image-20200517154917845" style="zoom: 80%;" />

假设我们选取圆A作为分析的起点，以半径$r$做圆，圆A和圆E相交于点K和点J，如果圆心放在弧JK上，那么必然保证点A和点E可以被圆覆盖。所以问题转化成，求与圆A相交的圆中，圆A的某一段弧被最多的圆包含，上图中，弧OJ就被圆H和圆E包含，那么圆心放在弧OJ上，必然保证点A，点E和点H被圆覆盖。

接下来是如何去描述这个弧，过点J做AE的中垂线，交点为P，显然$PE = \frac{AE}{2}$，其中AS所在的直线为水平线，我们设$\angle AEJ = \phi, \angle SAE = \theta$，我们把极坐标的原点建立在点A，因为弧在圆A上，半径是固定的，那么只需要弧对应的圆心角的起始角度和终止角度即可唯一确定一段弧。

比如描述弧JK，我们只需要求出$\angle KAS, \angle SAJ$即可，显然$\angle KAS = \phi - \theta, \angle SAJ = \theta + \phi$，那么根据几何关系求出两个角度就不难了。

现在考虑当E在过A的水平线下方的情况：

<img src="D:\Kylin\Advance-Algorithm\Algorithm Analysis\计算几何——固定半径圆能覆盖平面上的最大点数.assets\image-20200517162649745.png" alt="image-20200517162649745" style="zoom:80%;" />

发现起始角度是$\phi + \theta$，终止角度是$\phi - \theta$。



现在问题是如何找出哪一段弧被最多的圆包含，这就变成了一个区间选点的问题，我们以逆时针的顺序来描述一段弧，起始点是K，对应的起始角度就是$\angle KAS$，同理终止角度就是$\angle SAJ$，这就相当于区间的起点和终点。以往的区间选点是如何选取最少的点，来保证每个区间都至少有一个点；现在是选出一个点，让包含这个点的区间最多，其实原理是类似的。

