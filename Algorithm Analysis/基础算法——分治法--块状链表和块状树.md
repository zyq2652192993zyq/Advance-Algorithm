> # 数据结构——块状链表和块状树

《高级数据结构》林厚从，也叫数列分块。

参考资料：

* <https://www.cnblogs.com/flashhu/p/8437062.html>
* LOJ 地址：<https://loj.ac/problems/tag/207>
* https://www.bilibili.com/video/BV1Ep4y1C7iJ
* http://hzwer.com/8053.html#comment-8306

# 数列分块

分块：将数列分成一块一块的区间来处理和维护。

块：将数列分成若干个不相交的区间，每个区间称为一个块。

优点：适用范围广，常数小，空间小，代码原理简单，容易调试

## 区间加法，单点查询

- [x] LOJ 6277 数列分块入门1

给定一个长为$n$的数列，以及$n$个操作，操作涉及区间加法、单点查询。

第一行输入一个数字$n$。
第二行输入$n$个数字，第$i$个数字为$a_i$，以空格隔开。
接下来输入$n$行询问，每行输入四个数字$opt$、$l$、$r$、$c$，以空格隔开。
若$opt=0$，表示将位于$[l，r]$的之间的数字都加$c$。
若$opt=1$，表示询问$a_r$的值（$l$和$c$忽略）。

对于$100\% $的数据，$1 \leq n \leq 50000,-2^{31} \leq \text { others, ans } \leq 2^{31}-1$

----

分析：区间加法操作涉及$\left[ \frac{n}{m}\right]$个整块，以及区间两侧两个不完整的块中至多有$2m$个元素。

加法标记：标记一个块内的元素一起加了多少，时间复杂度$O(1)$。











## 区间加法，区间查询元素个数

- [ ] LOJ 6278 数列分块入门2



## 区间加法，查询区间最后一个小于目标值的元素

- [ ] LOJ 6279 数列分块入门3

## 区间加法 区间求和

- [ ] LOJ 6280 数列分块入门4

## 区间开方，区间求和

- [ ] LOJ 6281 数列分块入门5

## 单点插入，单点查询，随即数据生成

- [ ] LOJ 6282 数列分块入门6

## 区间乘法，区间加法，单点查询

- [ ] LOJ 6283 数列分块入门7

## 区间统计，区间修改

- [ ] LOJ 6284 数列分块入门8

## 区间查询最小众数

- [ ] LOJ 6285 数列分块入门9





## 动态区间第K大问题

给定一个数列，编号从 1 到 n，现在有 m 个操作，操作分两类：

　　1. 修改数列中某个位置的数的值为 val

　　2. 询问 [L, R] 这个区间中第 k 大的是多少

n<=50,000  m<=10,000。





典型问题：

- [ ]  ZOJ 2112 Dynamic Rankings（动态区间第K大）