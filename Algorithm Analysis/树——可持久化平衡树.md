> # 树——可持久化平衡树

- [ ] 洛谷-P3835 【模板】可持久化平衡树

您需要写一种数据结构（可参考题目标题），来维护一个可重整数集合，其中需要提供以下操作（ **对于各个以往的历史版本** ）：

1、 插入 $x$

2、 删除  $x$（若有多个相同的数，应只删除一个，**如果没有请忽略该操作**）

3、 查询  $x$的排名（排名定义为比当前数小的数的个数 +1）

4、查询排名为  $x$ 的数

5、 求  $x$的前驱（前驱定义为小于  $x$，且最大的数，**如不存在输出** $-2^{31}+1$）

6、求  $x$ 的后继（后继定义为大于  $x$，且最小的数，**如不存在输出** $-2^{31}-1$ ）

**和原本平衡树不同的一点是，每一次的任何操作都是基于某一个历史版本，同时生成一个新的版本。（操作3, 4, 5, 6即保持原版本无变化）**

每个版本的编号即为操作的序号（版本0即为初始状态，空树）